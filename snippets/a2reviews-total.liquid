{% assign A2MetaSettings = shop.metafields.a2reviews.settings.value %}
{% assign A2MetaProduct = product.metafields.a2reviews %}
{% assign A2MetaCollection = collection.metafields.a2reviews %}

{% assign isA2ShowInLoop = A2MetaSettings.total_widget_display_on contains 'loop' and template.name == null %}

{%- if A2MetaSettings.total_widget_display_on == null or isA2ShowInLoop or A2MetaSettings.total_widget_display_on contains template.name -%}
  
  {% if not (A2MetaCollection.status == 0 and type == 'collection') %}
    
    {% if A2MetaProduct.total_rating > 0 or A2MetaSettings.show_zero_count != false %}
      <a2-reviews-total
        {% if type == 'collection' %}collection{% endif %}
        handle="{{ product.handle }}"
        total="{{ A2MetaProduct.total_rating | default: 0 }}|{{ A2MetaProduct.xTR }}"
        avg="{{ A2MetaProduct.avg_rating | default: 0 }}"
        lang="{{ shop.locale }}"
        show-text="{% if type == 'collection' %}false{% else %}true{% endif %}"
        show-avg="false"
        {% if type != 'collection' %}
          callback="a2reviews_callback()"
          is-scroll
        {% endif %}
      ></a2-reviews-total>
    {% endif %}

  {% endif %}

  {% if type != 'collection' %}
  <script type="text/javascript">
    if (typeof a2reviews_callback === 'undefined') {
      function a2reviews_callback() {
        // Do callback
      }
    }
  </script>
  {% endif %}

{% endif %}
